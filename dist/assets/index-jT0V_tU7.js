(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(i){if(i.ep)return;i.ep=!0;const c=s(i);fetch(i.href,c)}})();var Q=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function yt(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var r=n.default;if(typeof r=="function"){var s=function o(){var i=!1;try{i=this instanceof o}catch{}return i?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};s.prototype=r.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(n).forEach(function(o){var i=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(s,o,i.get?i:{enumerable:!0,get:function(){return n[o]}})}),s}var R,V;function vt(){if(V)return R;V=1,R=n;function n(r){var s,o;if(typeof r!="function")throw new Error("expected a function but got "+r);return function(){return s||(s=!0,o=r.apply(this,arguments)),o}}return R}var q={},Z;function kt(){return Z||(Z=1,(function(n){function r(h,d){var y;return h instanceof Buffer?y=h:y=Buffer.from(h.buffer,h.byteOffset,h.byteLength),y.toString(d)}var s=function(h){return Buffer.from(h)};function o(h){for(var d=0,y=Math.min(256*256,h.length+1),v=new Uint16Array(y),T=[],b=0;;){var g=d<h.length;if(!g||b>=y-1){var D=v.subarray(0,b),I=D;if(T.push(String.fromCharCode.apply(null,I)),!g)return T.join("");h=h.subarray(d),d=0,b=0}var x=h[d++];if((x&128)===0)v[b++]=x;else if((x&224)===192){var M=h[d++]&63;v[b++]=(x&31)<<6|M}else if((x&240)===224){var M=h[d++]&63,B=h[d++]&63;v[b++]=(x&31)<<12|M<<6|B}else if((x&248)===240){var M=h[d++]&63,B=h[d++]&63,wt=h[d++]&63,F=(x&7)<<18|M<<12|B<<6|wt;F>65535&&(F-=65536,v[b++]=F>>>10&1023|55296,F=56320|F&1023),v[b++]=F}}}function i(h){for(var d=0,y=h.length,v=0,T=Math.max(32,y+(y>>>1)+7),b=new Uint8Array(T>>>3<<3);d<y;){var g=h.charCodeAt(d++);if(g>=55296&&g<=56319){if(d<y){var D=h.charCodeAt(d);(D&64512)===56320&&(++d,g=((g&1023)<<10)+(D&1023)+65536)}if(g>=55296&&g<=56319)continue}if(v+4>b.length){T+=8,T*=1+d/h.length*2,T=T>>>3<<3;var I=new Uint8Array(T);I.set(b),b=I}if((g&4294967168)===0){b[v++]=g;continue}else if((g&4294965248)===0)b[v++]=g>>>6&31|192;else if((g&4294901760)===0)b[v++]=g>>>12&15|224,b[v++]=g>>>6&63|128;else if((g&4292870144)===0)b[v++]=g>>>18&7|240,b[v++]=g>>>12&63|128,b[v++]=g>>>6&63|128;else continue;b[v++]=g&63|128}return b.slice?b.slice(0,v):b.subarray(0,v)}var c="Failed to ",a=function(h,d,y){if(h)throw new Error("".concat(c).concat(d,": the '").concat(y,"' option is unsupported."))},e=typeof Buffer=="function"&&Buffer.from,t=e?s:i;function u(){this.encoding="utf-8"}u.prototype.encode=function(h,d){return a(d&&d.stream,"encode","stream"),t(h)};function m(h){var d;try{var y=new Blob([h],{type:"text/plain;charset=UTF-8"});d=URL.createObjectURL(y);var v=new XMLHttpRequest;return v.open("GET",d,!1),v.send(),v.responseText}finally{d&&URL.revokeObjectURL(d)}}var _=!e&&typeof Blob=="function"&&typeof URL=="function"&&typeof URL.createObjectURL=="function",k=["utf-8","utf8","unicode-1-1-utf-8"],l=o;e?l=r:_&&(l=function(h){try{return m(h)}catch{return o(h)}});var f="construct 'TextDecoder'",p="".concat(c," ").concat(f,": the ");function w(h,d){a(d&&d.fatal,f,"fatal"),h=h||"utf-8";var y;if(e?y=Buffer.isEncoding(h):y=k.indexOf(h.toLowerCase())!==-1,!y)throw new RangeError("".concat(p," encoding label provided ('").concat(h,"') is invalid."));this.encoding=h,this.fatal=!1,this.ignoreBOM=!1}w.prototype.decode=function(h,d){a(d&&d.stream,"decode","stream");var y;return h instanceof Uint8Array?y=h:h.buffer instanceof ArrayBuffer?y=new Uint8Array(h.buffer):y=new Uint8Array(h),l(y,this.encoding)},n.TextEncoder=n.TextEncoder||u,n.TextDecoder=n.TextDecoder||w})(typeof window<"u"?window:typeof Q<"u"?Q:q)),q}var j,tt;function bt(){return tt||(tt=1,kt(),j={encode:n=>new TextEncoder().encode(n),decode:n=>new TextDecoder().decode(n)}),j}var L,et;function gt(){if(et)return L;et=1,L=n;function n(r,s,o){var i;return function(){if(!s)return r.apply(this,arguments);var c=this,a=arguments,e=o&&!i;if(clearTimeout(i),i=setTimeout(function(){if(i=null,!e)return r.apply(c,a)},s),e)return r.apply(this,arguments)}}return L}var N,it;function G(){if(it)return N;it=1;function n(e){if(e.length===0)return".";let t=o(e);return t=t.reduce(a,[]),s(...t)}function r(...e){let t="";for(let u of e)u.startsWith("/")?t=u:t=n(s(t,u));return t}function s(...e){if(e.length===0)return"";let t=e.join("/");return t=t.replace(/\/{2,}/g,"/"),t}function o(e){if(e.length===0)return[];if(e==="/")return["/"];let t=e.split("/");return t[t.length-1]===""&&t.pop(),e[0]==="/"?t[0]="/":t[0]!=="."&&t.unshift("."),t}function i(e){const t=e.lastIndexOf("/");if(t===-1)throw new Error(`Cannot get dirname of "${e}"`);return t===0?"/":e.slice(0,t)}function c(e){if(e==="/")throw new Error(`Cannot get basename of "${e}"`);const t=e.lastIndexOf("/");return t===-1?e:e.slice(t+1)}function a(e,t){if(e.length===0)return e.push(t),e;if(t===".")return e;if(t===".."){if(e.length===1){if(e[0]==="/")throw new Error("Unable to normalize path - traverses above root directory");if(e[0]===".")return e.push(t),e}return e[e.length-1]===".."?(e.push(".."),e):(e.pop(),e)}return e.push(t),e}return N={join:s,normalize:n,split:o,basename:c,dirname:i,resolve:r},N}var $,rt;function ft(){if(rt)return $;rt=1;function n(e){return class extends Error{constructor(...t){super(...t),this.code=e,this.message?this.message=e+": "+this.message:this.message=e}}}const r=n("EEXIST"),s=n("ENOENT"),o=n("ENOTDIR"),i=n("ENOTEMPTY"),c=n("ETIMEDOUT"),a=n("EISDIR");return $={EEXIST:r,ENOENT:s,ENOTDIR:o,ENOTEMPTY:i,ETIMEDOUT:c,EISDIR:a},$}var z,nt;function Et(){if(nt)return z;nt=1;const n=G(),{EEXIST:r,ENOENT:s,ENOTDIR:o,ENOTEMPTY:i,EISDIR:c}=ft(),a=0;return z=class{constructor(){}_makeRoot(t=new Map){return t.set(a,{mode:511,type:"dir",size:0,ino:0,mtimeMs:Date.now()}),t}activate(t=null){t===null?this._root=new Map([["/",this._makeRoot()]]):typeof t=="string"?this._root=new Map([["/",this._makeRoot(this.parse(t))]]):this._root=t}get activated(){return!!this._root}deactivate(){this._root=void 0}size(){return this._countInodes(this._root.get("/"))-1}_countInodes(t){let u=1;for(let[m,_]of t)m!==a&&(u+=this._countInodes(_));return u}autoinc(){return this._maxInode(this._root.get("/"))+1}_maxInode(t){let u=t.get(a).ino;for(let[m,_]of t)m!==a&&(u=Math.max(u,this._maxInode(_)));return u}print(t=this._root.get("/")){let u="";const m=(_,k)=>{for(let[l,f]of _){if(l===0)continue;let p=f.get(a),w=p.mode.toString(8);u+=`${"	".repeat(k)}${l}	${w}`,p.type==="file"?u+=`	${p.size}	${p.mtimeMs}
`:(u+=`
`,m(f,k+1))}};return m(t,0),u}parse(t){let u=0;function m(f){const p=++u,w=f.length===1?"dir":"file";let[h,d,y]=f;return h=parseInt(h,8),d=d?parseInt(d):0,y=y?parseInt(y):Date.now(),new Map([[a,{mode:h,type:w,size:d,mtimeMs:y,ino:p}]])}let _=t.trim().split(`
`),k=this._makeRoot(),l=[{indent:-1,node:k},{indent:0,node:null}];for(let f of _){let w=f.match(/^\t*/)[0].length;f=f.slice(w);let[h,...d]=f.split("	"),y=m(d);if(w<=l[l.length-1].indent)for(;w<=l[l.length-1].indent;)l.pop();l.push({indent:w,node:y}),l[l.length-2].node.set(h,y)}return k}_lookup(t,u=!0){let m=this._root,_="/",k=n.split(t);for(let l=0;l<k.length;++l){let f=k[l];if(m=m.get(f),!m)throw new s(t);if(u||l<k.length-1){const p=m.get(a);if(p.type==="symlink"){let w=n.resolve(_,p.target);m=this._lookup(w)}_?_=n.join(_,f):_=f}}return m}mkdir(t,{mode:u}){if(t==="/")throw new r;let m=this._lookup(n.dirname(t)),_=n.basename(t);if(m.has(_))throw new r;let k=new Map,l={mode:u,type:"dir",size:0,mtimeMs:Date.now(),ino:this.autoinc()};k.set(a,l),m.set(_,k)}rmdir(t){let u=this._lookup(t);if(u.get(a).type!=="dir")throw new o;if(u.size>1)throw new i;let m=this._lookup(n.dirname(t)),_=n.basename(t);m.delete(_)}readdir(t){let u=this._lookup(t);if(u.get(a).type!=="dir")throw new o;return[...u.keys()].filter(m=>typeof m=="string")}writeStat(t,u,{mode:m}){let _,k;try{k=this.stat(t)}catch{}if(k!==void 0){if(k.type==="dir")throw new c;m==null&&(m=k.mode),_=k.ino}m==null&&(m=438),_==null&&(_=this.autoinc());let l=this._lookup(n.dirname(t)),f=n.basename(t),p={mode:m,type:"file",size:u,mtimeMs:Date.now(),ino:_},w=new Map;return w.set(a,p),l.set(f,w),p}unlink(t){let u=this._lookup(n.dirname(t)),m=n.basename(t);u.delete(m)}rename(t,u){let m=n.basename(u),_=this._lookup(t);this._lookup(n.dirname(u)).set(m,_),this.unlink(t)}stat(t){return this._lookup(t).get(a)}lstat(t){return this._lookup(t,!1).get(a)}readlink(t){return this._lookup(t,!1).get(a).target}symlink(t,u){let m,_;try{let w=this.stat(u);_===null&&(_=w.mode),m=w.ino}catch{}_==null&&(_=40960),m==null&&(m=this.autoinc());let k=this._lookup(n.dirname(u)),l=n.basename(u),f={mode:_,type:"symlink",target:t,size:0,mtimeMs:Date.now(),ino:m},p=new Map;return p.set(a,f),k.set(l,p),f}_du(t){let u=0;for(const[m,_]of t.entries())m===a?u+=_.size:u+=this._du(_);return u}du(t){let u=this._lookup(t);return this._du(u)}},z}class mt{constructor(r="keyval-store",s="keyval"){this.storeName=s,this._dbName=r,this._storeName=s,this._init()}_init(){this._dbp||(this._dbp=new Promise((r,s)=>{const o=indexedDB.open(this._dbName);o.onerror=()=>s(o.error),o.onsuccess=()=>r(o.result),o.onupgradeneeded=()=>{o.result.createObjectStore(this._storeName)}}))}_withIDBStore(r,s){return this._init(),this._dbp.then(o=>new Promise((i,c)=>{const a=o.transaction(this.storeName,r);a.oncomplete=()=>i(),a.onabort=a.onerror=()=>c(a.error),s(a.objectStore(this.storeName))}))}_close(){return this._init(),this._dbp.then(r=>{r.close(),this._dbp=void 0})}}let A;function P(){return A||(A=new mt),A}function St(n,r=P()){let s;return r._withIDBStore("readwrite",o=>{s=o.get(n)}).then(()=>s.result)}function Tt(n,r,s=P()){return s._withIDBStore("readwrite",o=>{o.put(r,n)})}function xt(n,r,s=P()){return s._withIDBStore("readwrite",o=>{const i=o.get(n);i.onsuccess=()=>{o.put(r(i.result),n)}})}function Pt(n,r=P()){return r._withIDBStore("readwrite",s=>{s.delete(n)})}function Ft(n=P()){return n._withIDBStore("readwrite",r=>{r.clear()})}function Mt(n=P()){const r=[];return n._withIDBStore("readwrite",s=>{(s.openKeyCursor||s.openCursor).call(s).onsuccess=function(){this.result&&(r.push(this.result.key),this.result.continue())}}).then(()=>r)}function Ot(n=P()){return n._close()}const Dt=Object.freeze(Object.defineProperty({__proto__:null,Store:mt,clear:Ft,close:Ot,del:Pt,get:St,keys:Mt,set:Tt,update:xt},Symbol.toStringTag,{value:"Module"})),_t=yt(Dt);var C,st;function It(){if(st)return C;st=1;const n=_t;return C=class{constructor(s,o){this._database=s,this._storename=o,this._store=new n.Store(this._database,this._storename)}saveSuperblock(s){return n.set("!root",s,this._store)}loadSuperblock(){return n.get("!root",this._store)}readFile(s){return n.get(s,this._store)}writeFile(s,o){return n.set(s,o,this._store)}unlink(s){return n.del(s,this._store)}wipe(){return n.clear(this._store)}close(){return n.close(this._store)}},C}var U,at;function Bt(){return at||(at=1,U=class{constructor(r){this._url=r}loadSuperblock(){return fetch(this._url+"/.superblock.txt").then(r=>r.ok?r.text():null)}async readFile(r){const s=await fetch(this._url+r);if(s.status===200)return s.arrayBuffer();throw new Error("ENOENT")}async sizeFile(r){const s=await fetch(this._url+r,{method:"HEAD"});if(s.status===200)return s.headers.get("content-length");throw new Error("ENOENT")}}),U}var H,ot;function Rt(){if(ot)return H;ot=1;const n=_t,r=s=>new Promise(o=>setTimeout(o,s));return H=class{constructor(o,i){this._id=Math.random(),this._database=o,this._storename=i,this._store=new n.Store(this._database,this._storename),this._lock=null}async has({margin:o=2e3}={}){if(this._lock&&this._lock.holder===this._id){const i=Date.now();return this._lock.expires>i+o?!0:await this.renew()}else return!1}async renew({ttl:o=5e3}={}){let i;return await n.update("lock",c=>{const e=Date.now()+o;return i=c&&c.holder===this._id,this._lock=i?{holder:this._id,expires:e}:c,this._lock},this._store),i}async acquire({ttl:o=5e3}={}){let i,c,a;if(await n.update("lock",e=>{const t=Date.now(),u=t+o;return c=e&&e.expires<t,i=e===void 0||c,a=e&&e.holder===this._id,this._lock=i?{holder:this._id,expires:u}:e,this._lock},this._store),a)throw new Error("Mutex double-locked");return i}async wait({interval:o=100,limit:i=6e3,ttl:c}={}){for(;i--;){if(await this.acquire({ttl:c}))return!0;await r(o)}throw new Error("Mutex timeout")}async release({force:o=!1}={}){let i,c,a;if(await n.update("lock",e=>(i=o||e&&e.holder===this._id,c=e===void 0,a=e&&e.holder!==this._id,this._lock=i?void 0:e,this._lock),this._store),await n.close(this._store),!i&&!o){if(c)throw new Error("Mutex double-freed");if(a)throw new Error("Mutex lost ownership")}return i}},H}var W,ct;function qt(){return ct||(ct=1,W=class{constructor(r){this._id=Math.random(),this._database=r,this._has=!1,this._release=null}async has(){return this._has}async acquire(){return new Promise(r=>{navigator.locks.request(this._database+"_lock",{ifAvailable:!0},s=>(this._has=!!s,r(!!s),new Promise(o=>{this._release=o})))})}async wait({timeout:r=6e5}={}){return new Promise((s,o)=>{const i=new AbortController;setTimeout(()=>{i.abort(),o(new Error("Mutex timeout"))},r),navigator.locks.request(this._database+"_lock",{signal:i.signal},c=>(this._has=!!c,s(!!c),new Promise(a=>{this._release=a})))})}async release({force:r=!1}={}){this._has=!1,this._release?this._release():r&&navigator.locks.request(this._database+"_lock",{steal:!0},s=>!0)}}),W}var X,lt;function jt(){if(lt)return X;lt=1;const{encode:n,decode:r}=bt(),s=gt(),o=Et(),{ENOENT:i,ENOTEMPTY:c,ETIMEDOUT:a}=ft(),e=It(),t=Bt(),u=Rt(),m=qt(),_=G();return X=class{constructor(){this.saveSuperblock=s(()=>{this.flush()},500)}async init(l,{wipe:f,url:p,urlauto:w,fileDbName:h=l,db:d=null,fileStoreName:y=l+"_files",lockDbName:v=l+"_lock",lockStoreName:T=l+"_lock"}={}){this._name=l,this._idb=d||new e(h,y),this._mutex=navigator.locks?new m(l):new u(v,T),this._cache=new o(l),this._opts={wipe:f,url:p},this._needsWipe=!!f,p&&(this._http=new t(p),this._urlauto=!!w)}async activate(){if(this._cache.activated)return;this._needsWipe&&(this._needsWipe=!1,await this._idb.wipe(),await this._mutex.release({force:!0})),await this._mutex.has()||await this._mutex.wait();const l=await this._idb.loadSuperblock();if(l)this._cache.activate(l);else if(this._http){const f=await this._http.loadSuperblock();this._cache.activate(f),await this._saveSuperblock()}else this._cache.activate();if(!await this._mutex.has())throw new a}async deactivate(){await this._mutex.has()&&await this._saveSuperblock(),this._cache.deactivate();try{await this._mutex.release()}catch(l){console.log(l)}await this._idb.close()}async _saveSuperblock(){this._cache.activated&&(this._lastSavedAt=Date.now(),await this._idb.saveSuperblock(this._cache._root))}_writeStat(l,f,p){let w=_.split(_.dirname(l)),h=w.shift();for(let d of w){h=_.join(h,d);try{this._cache.mkdir(h,{mode:511})}catch{}}return this._cache.writeStat(l,f,p)}async readFile(l,f){const p=typeof f=="string"?f:f&&f.encoding;if(p&&p!=="utf8")throw new Error('Only "utf8" encoding is supported in readFile');let w=null,h=null;try{h=this._cache.stat(l),w=await this._idb.readFile(h.ino)}catch(d){if(!this._urlauto)throw d}if(!w&&this._http){let d=this._cache.lstat(l);for(;d.type==="symlink";)l=_.resolve(_.dirname(l),d.target),d=this._cache.lstat(l);w=await this._http.readFile(l)}if(w&&((!h||h.size!=w.byteLength)&&(h=await this._writeStat(l,w.byteLength,{mode:h?h.mode:438}),this.saveSuperblock()),p==="utf8"?w=r(w):w.toString=()=>r(w)),!h)throw new i(l);return w}async writeFile(l,f,p){const{mode:w,encoding:h="utf8"}=p;if(typeof f=="string"){if(h!=="utf8")throw new Error('Only "utf8" encoding is supported in writeFile');f=n(f)}const d=await this._cache.writeStat(l,f.byteLength,{mode:w});await this._idb.writeFile(d.ino,f)}async unlink(l,f){const p=this._cache.lstat(l);this._cache.unlink(l),p.type!=="symlink"&&await this._idb.unlink(p.ino)}readdir(l,f){return this._cache.readdir(l)}mkdir(l,f){const{mode:p=511}=f;this._cache.mkdir(l,{mode:p})}rmdir(l,f){if(l==="/")throw new c;this._cache.rmdir(l)}rename(l,f){this._cache.rename(l,f)}stat(l,f){return this._cache.stat(l)}lstat(l,f){return this._cache.lstat(l)}readlink(l,f){return this._cache.readlink(l)}symlink(l,f){this._cache.symlink(l,f)}async backFile(l,f){let p=await this._http.sizeFile(l);await this._writeStat(l,p,f)}du(l){return this._cache.du(l)}flush(){return this._saveSuperblock()}},X}var J,ut;function Lt(){return ut||(ut=1,J=class{constructor(r){this.type=r.type,this.mode=r.mode,this.size=r.size,this.ino=r.ino,this.mtimeMs=r.mtimeMs,this.ctimeMs=r.ctimeMs||r.mtimeMs,this.uid=1,this.gid=1,this.dev=1}isFile(){return this.type==="file"}isDirectory(){return this.type==="dir"}isSymbolicLink(){return this.type==="symlink"}}),J}var Y,ht;function Nt(){if(ht)return Y;ht=1;const n=jt(),r=Lt(),s=G();function o(a,e,...t){return a=s.normalize(a),(typeof e>"u"||typeof e=="function")&&(e={}),typeof e=="string"&&(e={encoding:e}),[a,e,...t]}function i(a,e,t,...u){return a=s.normalize(a),(typeof t>"u"||typeof t=="function")&&(t={}),typeof t=="string"&&(t={encoding:t}),[a,e,t,...u]}function c(a,e,...t){return[s.normalize(a),s.normalize(e),...t]}return Y=class{constructor(e,t={}){this.init=this.init.bind(this),this.readFile=this._wrap(this.readFile,o,!1),this.writeFile=this._wrap(this.writeFile,i,!0),this.unlink=this._wrap(this.unlink,o,!0),this.readdir=this._wrap(this.readdir,o,!1),this.mkdir=this._wrap(this.mkdir,o,!0),this.rmdir=this._wrap(this.rmdir,o,!0),this.rename=this._wrap(this.rename,c,!0),this.stat=this._wrap(this.stat,o,!1),this.lstat=this._wrap(this.lstat,o,!1),this.readlink=this._wrap(this.readlink,o,!1),this.symlink=this._wrap(this.symlink,c,!0),this.backFile=this._wrap(this.backFile,o,!0),this.du=this._wrap(this.du,o,!1),this._deactivationPromise=null,this._deactivationTimeout=null,this._activationPromise=null,this._operations=new Set,e&&this.init(e,t)}async init(...e){return this._initPromiseResolve&&await this._initPromise,this._initPromise=this._init(...e),this._initPromise}async _init(e,t={}){await this._gracefulShutdown(),this._activationPromise&&await this._deactivate(),this._backend&&this._backend.destroy&&await this._backend.destroy(),this._backend=t.backend||new n,this._backend.init&&await this._backend.init(e,t),this._initPromiseResolve&&(this._initPromiseResolve(),this._initPromiseResolve=null),t.defer||this.stat("/")}async _gracefulShutdown(){this._operations.size>0&&(this._isShuttingDown=!0,await new Promise(e=>this._gracefulShutdownResolve=e),this._isShuttingDown=!1,this._gracefulShutdownResolve=null)}_wrap(e,t,u){return async(...m)=>{m=t(...m);let _={name:e.name,args:m};this._operations.add(_);try{return await this._activate(),await e.apply(this,m)}finally{this._operations.delete(_),u&&this._backend.saveSuperblock(),this._operations.size===0&&(this._deactivationTimeout||clearTimeout(this._deactivationTimeout),this._deactivationTimeout=setTimeout(this._deactivate.bind(this),500))}}}async _activate(){this._initPromise||console.warn(new Error(`Attempted to use LightningFS ${this._name} before it was initialized.`)),await this._initPromise,this._deactivationTimeout&&(clearTimeout(this._deactivationTimeout),this._deactivationTimeout=null),this._deactivationPromise&&await this._deactivationPromise,this._deactivationPromise=null,this._activationPromise||(this._activationPromise=this._backend.activate?this._backend.activate():Promise.resolve()),await this._activationPromise}async _deactivate(){return this._activationPromise&&await this._activationPromise,this._deactivationPromise||(this._deactivationPromise=this._backend.deactivate?this._backend.deactivate():Promise.resolve()),this._activationPromise=null,this._gracefulShutdownResolve&&this._gracefulShutdownResolve(),this._deactivationPromise}async readFile(e,t){return this._backend.readFile(e,t)}async writeFile(e,t,u){return await this._backend.writeFile(e,t,u),null}async unlink(e,t){return await this._backend.unlink(e,t),null}async readdir(e,t){return this._backend.readdir(e,t)}async mkdir(e,t){return await this._backend.mkdir(e,t),null}async rmdir(e,t){return await this._backend.rmdir(e,t),null}async rename(e,t){return await this._backend.rename(e,t),null}async stat(e,t){const u=await this._backend.stat(e,t);return new r(u)}async lstat(e,t){const u=await this._backend.lstat(e,t);return new r(u)}async readlink(e,t){return this._backend.readlink(e,t)}async symlink(e,t){return await this._backend.symlink(e,t),null}async backFile(e,t){return await this._backend.backFile(e,t),null}async du(e){return this._backend.du(e)}async flush(){return this._backend.flush()}},Y}var K,dt;function $t(){if(dt)return K;dt=1;const n=vt(),r=Nt();function s(o,i){return typeof o=="function"&&(i=o),i=n(i),[(...a)=>i(null,...a),i]}return K=class{constructor(...i){this.promises=new r(...i),this.init=this.init.bind(this),this.readFile=this.readFile.bind(this),this.writeFile=this.writeFile.bind(this),this.unlink=this.unlink.bind(this),this.readdir=this.readdir.bind(this),this.mkdir=this.mkdir.bind(this),this.rmdir=this.rmdir.bind(this),this.rename=this.rename.bind(this),this.stat=this.stat.bind(this),this.lstat=this.lstat.bind(this),this.readlink=this.readlink.bind(this),this.symlink=this.symlink.bind(this),this.backFile=this.backFile.bind(this),this.du=this.du.bind(this),this.flush=this.flush.bind(this)}init(i,c){return this.promises.init(i,c)}readFile(i,c,a){const[e,t]=s(c,a);this.promises.readFile(i,c).then(e).catch(t)}writeFile(i,c,a,e){const[t,u]=s(a,e);this.promises.writeFile(i,c,a).then(t).catch(u)}unlink(i,c,a){const[e,t]=s(c,a);this.promises.unlink(i,c).then(e).catch(t)}readdir(i,c,a){const[e,t]=s(c,a);this.promises.readdir(i,c).then(e).catch(t)}mkdir(i,c,a){const[e,t]=s(c,a);this.promises.mkdir(i,c).then(e).catch(t)}rmdir(i,c,a){const[e,t]=s(c,a);this.promises.rmdir(i,c).then(e).catch(t)}rename(i,c,a){const[e,t]=s(a);this.promises.rename(i,c).then(e).catch(t)}stat(i,c,a){const[e,t]=s(c,a);this.promises.stat(i).then(e).catch(t)}lstat(i,c,a){const[e,t]=s(c,a);this.promises.lstat(i).then(e).catch(t)}readlink(i,c,a){const[e,t]=s(c,a);this.promises.readlink(i).then(e).catch(t)}symlink(i,c,a){const[e,t]=s(a);this.promises.symlink(i,c).then(e).catch(t)}backFile(i,c,a){const[e,t]=s(c,a);this.promises.backFile(i,c).then(e).catch(t)}du(i,c){const[a,e]=s(c);this.promises.du(i).then(a).catch(e)}flush(i){const[c,a]=s(i);this.promises.flush().then(c).catch(a)}},K}var zt=$t();const At=pt(zt),O=new At("fs");let E="~",S=document.getElementById("gitBash");window.addEventListener("DOMContentLoaded",()=>{S=document.getElementById("gitBash"),S instanceof HTMLTextAreaElement&&(S.value=`${E} $ `)});const Ct=n=>{S instanceof HTMLTextAreaElement&&(S.value+=`
${n} $ `,S.scrollTop=S.scrollHeight)},Ut=async n=>{const r=n.trim().split(/\s+/),s=r[0];try{switch(s){case"mkdir":if(r.length<2)return"mkdir: 你沒有說要建立什麼資料夾";const o=r[1].startsWith("/")?r[1]:`${E==="~"?"":E}/${r[1]}`.replace(/\/+/g,"/");try{await O.promises.mkdir(o)}catch(u){if(u instanceof Error&&"code"in u&&u.code!=="EEXIST")return`mkdir: 無法建立資料夾 '${r[1]}'`}return"";case"echo":const i=r.indexOf(">");if(i>0&&r.length>i+1){const u=r.slice(1,i).join(" ").replace(/"/g,""),m=r[i+1],_=m.startsWith("/")?m:`${E==="~"?"":E}/${m}`.replace(/\/+/g,"/");return await O.promises.writeFile(_,u),""}else return r.slice(1).join(" ").replace(/"/g,"");case"cat":if(r.length<2)return"cat: 你沒有說要讀取哪個檔案";const c=r[1].startsWith("/")?r[1]:`${E==="~"?"":E}/${r[1]}`.replace(/\/+/g,"/");return await O.promises.readFile(c,{encoding:"utf8"});case"ls":const e=r.length>1?r[1]:E;return(await O.promises.readdir(e)).join("  ");case"cd":if(r.length<2)E="~";else if(r[1]==="~")E="~";else{const u=r[1].startsWith("/")?r[1]:`${E==="~"?"":E}/${r[1]}`.replace(/\/+/g,"/");try{await O.promises.readdir(u),E=u}catch{return`cd: ${r[1]}: 找不到資料夾`}}return"";case"pwd":return E==="~"?"~":E;case"clear":return S instanceof HTMLTextAreaElement&&(S.value=""),"";case"":return"";default:return`${s}: 找不到這個指令`}}catch(o){return`錯誤: ${o instanceof Error?o.message:String(o)}`}};async function Ht(n){for(let r of n){let s=await Ut(r);s&&S instanceof HTMLTextAreaElement&&(S.value+=`
${s}`)}}window.addEventListener("keydown",async n=>{if(n.key==="Enter"&&S instanceof HTMLTextAreaElement){n.preventDefault();const r=S.value.lastIndexOf("$ ");if(r===-1)return;const o=S.value.slice(r+2).split(`
`).map(i=>i.trim()).filter(i=>i!=="");await Ht(o)}});window.addEventListener("keyup",async n=>{n.key==="Enter"&&S instanceof HTMLTextAreaElement&&Ct(E)});
